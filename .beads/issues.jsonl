{"id":"gitlab-insights-0f6","title":"Phase 5: Migration Path","description":"Smooth transition with user preference toggle between views.\n\n## Goal\nAllow users to switch between grouped (new) and flat (old) views.\n\n## On Completion (Epic)\nWhen all Phase 5 tasks complete:\n1. All ACs should be marked 'complete' in plan file\n2. bd close gitlab-insights-0f6","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-11T14:25:06.844896-05:00","updated_at":"2025-12-11T15:10:35.452296-05:00","dependencies":[{"issue_id":"gitlab-insights-0f6","depends_on_id":"gitlab-insights-ntz","type":"blocks","created_at":"2025-12-11T14:25:36.31061-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-0rj","title":"Phase 2: Enhanced Data Layer","description":"Create new tRPC endpoints that leverage relationships for grouped queries.\n\n## Goal\nBuild data layer to serve hierarchical work item data to UI.\n\n## Key Files\n- src/server/api/routers/events.ts\n- src/server/services/event-relationships.ts (new)\n\n## Acceptance Criteria\nContributes to: AC-5\n\n## On Completion (Epic)\nWhen all Phase 2 tasks complete:\n1. Verify AC-5 is marked 'implemented' in plan file\n2. bd close gitlab-insights-0rj","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-11T14:24:24.796401-05:00","updated_at":"2025-12-11T15:08:37.781133-05:00","dependencies":[{"issue_id":"gitlab-insights-0rj","depends_on_id":"gitlab-insights-9mx","type":"blocks","created_at":"2025-12-11T14:25:35.68822-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-0zb","title":"3.8 Add empty states","description":"Add empty state displays for various scenarios.\n\n## Implementation\n\nNo open issues:\n\"No open issues\"\n\nNo open MRs:\n\"No open merge requests\"\n\nNo search results:\n\"No items match your search. Try adjusting your query or clearing filters.\"\n\nSection with 0 items:\nShow section header with (0) count, collapsed by default\n\n## Files\n- WorkItemList.tsx\n\n---\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-0zb: Add empty states\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-0zb","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:24:47.305803-05:00","updated_at":"2025-12-11T15:09:55.488702-05:00","dependencies":[{"issue_id":"gitlab-insights-0zb","depends_on_id":"gitlab-insights-uln","type":"blocks","created_at":"2025-12-11T14:26:41.091576-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-5kc","title":"2.4 Add unread status to grouped queries","description":"Update getWorkItemsGrouped to include unread status based on ReadEvent.\n\n## Implementation\nIn getWorkItemsGrouped query:\n\nFor each work item, determine:\n- hasNewActivity: true if:\n  - No ReadEvent exists for this user+event, OR\n  - lastActivityAt \u003e readAt\n- unreadComments: count of child comments where:\n  - No ReadEvent exists, OR\n  - comment.createdAt \u003e readAt\n\nUse Prisma subquery or raw SQL for efficiency.\n\n## File\nsrc/server/api/routers/events.ts\n\n---\n## Acceptance Criteria\nContributes to: AC-4\n\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-5kc: Add unread status to grouped queries\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-5kc\n- Update plan: AC-4 -\u003e \"query-ready\"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:24:25.780296-05:00","updated_at":"2025-12-11T15:08:38.751919-05:00","dependencies":[{"issue_id":"gitlab-insights-5kc","depends_on_id":"gitlab-insights-myl","type":"blocks","created_at":"2025-12-11T14:26:29.023681-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-5oj","title":"1.6 Update event transformer for issues","description":"Update event-transformer.ts to capture issue metadata.\n\n## Implementation\nMap GitLab Issues API fields directly:\n- issue.assignees[].username -\u003e assignees[]\n- issue.state -\u003e status (\"opened\" | \"closed\")\n- issue.updated_at -\u003e lastActivityAt\n- issue.user_notes_count -\u003e commentCount\n\n## File\nsrc/server/services/gitlab/event-transformer.ts\n\n---\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-5oj: Update event transformer for issues\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-5oj","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:24:06.442139-05:00","updated_at":"2025-12-11T15:07:52.986747-05:00","dependencies":[{"issue_id":"gitlab-insights-5oj","depends_on_id":"gitlab-insights-ksg","type":"blocks","created_at":"2025-12-11T14:25:47.679909-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-7e5","title":"1.7 Update event transformer for MRs","description":"Update event-transformer.ts to capture MR metadata and closes relationships.\n\n## Implementation\nMap GitLab MRs API fields directly:\n- merge_request.assignees[].username -\u003e assignees[]\n- merge_request.state -\u003e status (\"opened\" | \"closed\" | \"merged\")\n- merge_request.updated_at -\u003e lastActivityAt\n- merge_request.user_notes_count -\u003e commentCount\n\nFor closesIssueIds, call GitLab API endpoint:\n- GET /projects/:id/merge_requests/:mr_iid/closes_issues\n- Extract IIDs from response array\n- Store in closesIssueIds[]\n\nMay need to add this API call to gitlab-api.ts or equivalent.\n\n## Files\n- src/server/services/gitlab/event-transformer.ts\n- src/server/services/gitlab/gitlab-api.ts (if exists)\n\n---\n## Acceptance Criteria\nContributes to: AC-2\n\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-7e5: Update event transformer for MRs\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-7e5\n- Update plan: AC-2 -\u003e \"implemented\"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:24:06.68728-05:00","updated_at":"2025-12-11T15:07:53.231732-05:00","dependencies":[{"issue_id":"gitlab-insights-7e5","depends_on_id":"gitlab-insights-ksg","type":"blocks","created_at":"2025-12-11T14:25:48.046357-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-82a","title":"1.2 Create ReadEvent model","description":"Create new ReadEvent model for tracking which events each user has read.\n\n## Implementation\nAdd to prisma/schema.prisma:\n\nmodel ReadEvent {\n  id        String   @id @default(cuid())\n  userId    String\n  eventId   String\n  readAt    DateTime @default(now())\n\n  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)\n  event     Event    @relation(fields: [eventId], references: [id], onDelete: Cascade)\n\n  @@unique([userId, eventId])\n  @@index([userId, readAt])\n}\n\nAlso add relation to User model:\nreadEvents  ReadEvent[]\n\nAnd to Event model:\nreadBy      ReadEvent[]\n\n## File\nprisma/schema.prisma\n\n---\n## Acceptance Criteria\nContributes to: AC-4, AC-9\n\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-82a: Create ReadEvent model\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-82a\n- Update plan: AC-4, AC-9 -\u003e \"schema-ready\"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:23:57.412545-05:00","updated_at":"2025-12-11T15:07:30.588998-05:00"}
{"id":"gitlab-insights-9ed","title":"3.5 Update DashboardClient for grouped view","description":"Update DashboardClient to use new WorkItemList component.\n\n## Implementation\nModify src/app/(authenticated)/dashboard/_components/DashboardClient.tsx\n\n1. Import WorkItemList component\n2. Use getWorkItemsGrouped query instead of flat events query\n3. Conditionally render based on user's dashboardView preference:\n   - \"grouped\": render WorkItemList\n   - \"flat\": render EventTable (existing)\n4. Handle item selection and detail pane updates\n5. Handle activity item clicks (scroll detail pane)\n\n## State Management\n- selectedItemId: string | null\n- expandedCardIds: Set\u003cstring\u003e\n\n## File\nsrc/app/(authenticated)/dashboard/_components/DashboardClient.tsx\n\n---\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-9ed: Update DashboardClient for grouped view\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-9ed","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:24:46.622726-05:00","updated_at":"2025-12-11T15:09:54.819453-05:00","dependencies":[{"issue_id":"gitlab-insights-9ed","depends_on_id":"gitlab-insights-fww","type":"blocks","created_at":"2025-12-11T14:26:03.442647-05:00","created_by":"daemon"},{"issue_id":"gitlab-insights-9ed","depends_on_id":"gitlab-insights-9vb","type":"blocks","created_at":"2025-12-11T14:26:03.648523-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-9jt","title":"5.1 Add view toggle to dashboard header","description":"Add toggle in dashboard header to switch views.\n\n## Implementation\nAdd toggle component in dashboard header:\n- Label: \"View\"\n- Options: \"Grouped\" | \"Flat\"\n- Default: \"Grouped\"\n\nOn change:\n- Update user's dashboardView preference via API\n- Re-render dashboard with selected view\n\n## Files\n- src/app/(authenticated)/dashboard/_components/DashboardClient.tsx\n- May need new API endpoint to update user preference\n\n---\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-9jt: Add view toggle to dashboard header\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-9jt","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:25:07.079833-05:00","updated_at":"2025-12-11T15:10:35.690667-05:00","dependencies":[{"issue_id":"gitlab-insights-9jt","depends_on_id":"gitlab-insights-a6q","type":"blocks","created_at":"2025-12-11T14:26:54.023636-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-9mx","title":"Phase 1: Data Model \u0026 Re-fetch","description":"Update schema and refetch all data with relationships. Clean slate approach.\n\n## Goal\nTransform flat event model into hierarchical structure where comments are grouped under parent issues/MRs.\n\n## Approach\n- Wipe Event table data (preserve User, UserQuery, MonitoredProject)\n- Add relationship fields to Event model\n- Create ReadEvent model for read tracking\n- Update transformers to map GitLab API directly\n- Refetch all data with new schema\n\n## Key Files\n- prisma/schema.prisma\n- src/server/services/gitlab/event-transformer.ts\n- src/server/services/gitlab/types.ts\n\n## Acceptance Criteria\nContributes to: AC-1, AC-2, AC-3\n\n## On Completion (Epic)\nWhen all Phase 1 tasks complete:\n1. Verify AC-1, AC-2, AC-3 are marked 'implemented' in plan file\n2. bd close gitlab-insights-9mx","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-11T14:23:56.805113-05:00","updated_at":"2025-12-11T15:07:30.104581-05:00"}
{"id":"gitlab-insights-9vb","title":"3.2 Create WorkItemList component","description":"Create list component grouping WorkItemCards by type.\n\n## Implementation\nCreate src/app/(authenticated)/dashboard/_components/WorkItemList.tsx\n\nProps:\n- issues: WorkItemSummary[]\n- mergeRequests: WorkItemSummary[]\n- selectedId: string | null\n- onSelectItem: (id: string) =\u003e void\n- onActivityItemClick: (eventId: string, activityId: string) =\u003e void\n\n## Layout\n+--------------------------------------------------+\n| Issues (12) - 3 new        [Sort: Activity v]    |\n|--------------------------------------------------|\n| [WorkItemCard]                                   |\n| [WorkItemCard]                                   |\n| [WorkItemCard]                                   |\n|--------------------------------------------------|\n| Merge Requests (8)         [Sort: Activity v]    |\n|--------------------------------------------------|\n| [WorkItemCard]                                   |\n| [WorkItemCard]                                   |\n+--------------------------------------------------+\n\n## Features\n- Section headers are sticky when scrolling\n- Section headers are collapsible (click to collapse all cards)\n- Multiple cards can be expanded simultaneously\n- Sort dropdown in section header\n\n## File\nsrc/app/(authenticated)/dashboard/_components/WorkItemList.tsx\n\n---\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-9vb: Create WorkItemList component\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-9vb","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:24:38.706094-05:00","updated_at":"2025-12-11T15:09:21.522902-05:00","dependencies":[{"issue_id":"gitlab-insights-9vb","depends_on_id":"gitlab-insights-fww","type":"blocks","created_at":"2025-12-11T14:26:03.235006-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-a6q","title":"4.1 Mark as read on expand/view","description":"Trigger markAsRead when user expands card or views in detail.\n\n## Implementation\nIn DashboardClient.tsx:\n\n1. When card is expanded:\n   - Call markAsRead mutation with eventId\n   - Update local state to remove NEW badge\n\n2. When item is selected for detail pane:\n   - Call markAsRead mutation with eventId\n   - Update local state\n\n3. Optimistic update:\n   - Remove NEW badge immediately\n   - Revert if mutation fails\n\n## File\nsrc/app/(authenticated)/dashboard/_components/DashboardClient.tsx\n\n---\n## Acceptance Criteria\nContributes to: AC-4, AC-9\n\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-a6q: Mark as read on expand/view\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-a6q\n- Update plan: AC-4, AC-9 -\u003e \"complete\"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:25:00.820574-05:00","updated_at":"2025-12-11T15:10:21.396416-05:00","dependencies":[{"issue_id":"gitlab-insights-a6q","depends_on_id":"gitlab-insights-9ed","type":"blocks","created_at":"2025-12-11T14:26:48.686869-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-bgm","title":"1.1 Update Prisma schema with relationship fields","description":"Add relationship and metadata fields to the Event model in prisma/schema.prisma.\n\n## Implementation\nAdd these fields to Event model:\n\n// Relationship fields\nparentType      String?   // \"issue\" | \"merge_request\"\nparentEventId   String?   // FK to parent Event\ngitlabParentId  Int?      // GitLab issue/MR IID\n\n// MR -\u003e Issue relationships\nclosesIssueIds  Int[]     // Array of GitLab issue IIDs this MR closes\n\n// Cross-references\nmentionedInIds  Int[]     // GitLab IIDs mentioned in this item\n\n// System note flag\nisSystemNote    Boolean   @default(false)\n\n// People involvement\nassignees       String[]  // Array of assignee usernames\nparticipants    String[]  // Everyone who commented/interacted\n\n// Activity metadata\ncommentCount    Int       @default(0)\nlastActivityAt  DateTime\nstatus          String    // \"open\" | \"closed\" | \"merged\"\n\nAdd self-relation:\nparent          Event?    @relation(\"EventHierarchy\", fields: [parentEventId], references: [id])\nchildren        Event[]   @relation(\"EventHierarchy\")\n\nAdd indexes:\n@@index([parentEventId, createdAt])\n@@index([gitlabParentId])\n@@index([status, lastActivityAt])\n@@index([userId, type, status])\n\n## File\nprisma/schema.prisma\n\n---\n## Acceptance Criteria\nContributes to: AC-1, AC-2, AC-3\n\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-bgm: Add relationship fields to Event model\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-bgm\n- Update plan: AC-1, AC-2, AC-3 -\u003e \"schema-ready\"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:23:57.148543-05:00","updated_at":"2025-12-11T15:07:30.358622-05:00"}
{"id":"gitlab-insights-bug","title":"4.2 Default sort: unread first","description":"Implement default sort order: unread items first, then by activity.\n\n## Implementation\nIn WorkItemList.tsx:\n\nDefault sort:\n1. Items with hasNewActivity = true (NEW badge)\n2. Then by lastActivityAt descending\n\nAdd sort dropdown with options:\n- \"Unread first\" (default)\n- \"Latest activity\"\n- \"Most comments\"\n- \"Assigned to me\"\n\n## File\nsrc/app/(authenticated)/dashboard/_components/WorkItemList.tsx\n\n---\n## Acceptance Criteria\nContributes to: AC-4\n\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-bug: Default sort - unread first\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-bug","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:25:01.044437-05:00","updated_at":"2025-12-11T15:10:21.723696-05:00","dependencies":[{"issue_id":"gitlab-insights-bug","depends_on_id":"gitlab-insights-9ed","type":"blocks","created_at":"2025-12-11T14:26:48.923381-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-ch8","title":"4.4 Search includes all items with Hide closed filter","description":"Make search return all items (open + closed) with filter toggle.\n\n## Implementation\nWhen search/query is active:\n- Default: show all items matching query (open + closed)\n- Add \"Hide closed\" toggle near search bar\n- When toggled: filter out closed/merged items\n\nThis allows users to find historical/archived items via search.\n\n## Files\n- src/app/(authenticated)/dashboard/_components/DashboardClient.tsx\n- Search-related components\n\n---\n## Acceptance Criteria\nContributes to: AC-8\n\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-ch8: Search includes all items with Hide closed filter\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-ch8\n- Update plan: AC-8 -\u003e \"complete\"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:25:01.511918-05:00","updated_at":"2025-12-11T15:10:22.163708-05:00","dependencies":[{"issue_id":"gitlab-insights-ch8","depends_on_id":"gitlab-insights-9ed","type":"blocks","created_at":"2025-12-11T14:26:49.34145-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-e0h","title":"1.5 Update event transformer for notes/comments","description":"Update event-transformer.ts to capture parent relationships for comments.\n\n## Implementation\nIn src/server/services/gitlab/event-transformer.ts, when transforming notes:\n\nMap GitLab Notes API fields directly:\n- note.noteable_id -\u003e gitlabParentId\n- note.noteable_type -\u003e parentType (convert \"Issue\" | \"MergeRequest\")\n- note.system -\u003e isSystemNote\n\nAfter creating the Event, look up parent:\n- Query Event where gitlabEventId = gitlabParentId AND type matches parentType\n- Set parentEventId to found Event's id\n\n## File\nsrc/server/services/gitlab/event-transformer.ts\n\n---\n## Acceptance Criteria\nContributes to: AC-1\n\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-e0h: Update event transformer for notes/comments\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-e0h\n- Update plan: AC-1 -\u003e \"implemented\"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:24:06.215644-05:00","updated_at":"2025-12-11T15:07:52.754952-05:00","dependencies":[{"issue_id":"gitlab-insights-e0h","depends_on_id":"gitlab-insights-ksg","type":"blocks","created_at":"2025-12-11T14:25:47.417303-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-fww","title":"3.1 Create WorkItemCard component","description":"Create collapsible card component for issues/MRs.\n\n## Implementation\nCreate src/app/(authenticated)/dashboard/_components/WorkItemCard.tsx\n\nProps:\n- workItem: WorkItemSummary\n- isSelected: boolean\n- isExpanded: boolean\n- onToggleExpand: () =\u003e void\n- onSelect: () =\u003e void\n- onActivityItemClick: (activityId: string) =\u003e void\n\n## Card Layout\n\nCollapsed (default):\n+--------------------------------------------------+\n| [Badge] #123 Title here...            [NEW] [v] |\n| Open - Alice - 2 days ago                        |\n| 3 new comments - [avatars] 5 participants        |\n| Latest: \"Bob commented: I think the...\"          |\n| Related: MR !456 (merged) - Labels: bug, auth    |\n+--------------------------------------------------+\n\nExpanded:\n+--------------------------------------------------+\n| [Badge] #123 Title here...            [NEW] [^] |\n| Open - Alice - 2 days ago                        |\n|--------------------------------------------------|\n| Activity Log:                                    |\n| - Bob commented: \"I think the root cause...\"     |\n| - Alice changed status: Open -\u003e In Progress      |\n| - Dave commented: \"I can reproduce this...\"      |\n| [scrollable, max-height ~1000px]                 |\n+--------------------------------------------------+\n\n## Styling (from UX spec)\n- Card background: bg-gray-50 (light) / bg-gray-800 (dark)\n- Border: border-gray-200 (light) / border-gray-600 (dark)\n- NEW badge: olive accent color\n- Selected state: ring/outline\n- Query match: olive left border\n\n## Interactions\n- Header click: toggle expand\n- Activity item click: call onActivityItemClick\n- Related item click: emit event to scroll to that card\n\n## File\nsrc/app/(authenticated)/dashboard/_components/WorkItemCard.tsx\n\n---\n## Acceptance Criteria\nContributes to: AC-6, AC-7\n\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-fww: Create WorkItemCard component\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-fww\n- Update plan: AC-6, AC-7 -\u003e \"ui-ready\"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:24:38.463687-05:00","updated_at":"2025-12-11T15:09:21.304084-05:00","dependencies":[{"issue_id":"gitlab-insights-fww","depends_on_id":"gitlab-insights-uln","type":"blocks","created_at":"2025-12-11T14:26:40.143605-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-gcv","title":"1.3 Add dashboardView preference to User model","description":"Add user preference field for switching between grouped and flat views.\n\n## Implementation\nAdd to User model in prisma/schema.prisma:\n\ndashboardView   String   @default(\"grouped\")  // \"grouped\" | \"flat\"\n\n## File\nprisma/schema.prisma\n\n---\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-gcv: Add dashboardView preference to User model\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-gcv","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:23:57.67338-05:00","updated_at":"2025-12-11T15:07:30.812166-05:00"}
{"id":"gitlab-insights-gj9","title":"2.3 Create markAsRead endpoint","description":"Create tRPC mutation to mark events as read.\n\n## Implementation\nAdd to src/server/api/routers/events.ts:\n\nmarkAsRead: protectedProcedure\n  .input(z.object({ eventId: z.string() }))\n  .mutation(async ({ ctx, input }) =\u003e {\n    await ctx.db.readEvent.upsert({\n      where: {\n        userId_eventId: {\n          userId: ctx.session.user.id,\n          eventId: input.eventId\n        }\n      },\n      create: {\n        userId: ctx.session.user.id,\n        eventId: input.eventId\n      },\n      update: {\n        readAt: new Date()\n      }\n    });\n  })\n\n## File\nsrc/server/api/routers/events.ts\n\n---\n## Acceptance Criteria\nContributes to: AC-9\n\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-gj9: Create markAsRead endpoint\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-gj9\n- Update plan: AC-9 -\u003e \"implemented\"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:24:25.521544-05:00","updated_at":"2025-12-11T15:08:38.49905-05:00","dependencies":[{"issue_id":"gitlab-insights-gj9","depends_on_id":"gitlab-insights-myl","type":"blocks","created_at":"2025-12-11T14:26:28.823924-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-ipd","title":"4.3 Dashboard shows open items only","description":"Filter main dashboard to show only open items.\n\n## Implementation\nIn DashboardClient.tsx:\n\nPass status: \"open\" to getWorkItemsGrouped query by default.\nThis excludes status = \"closed\" and status = \"merged\".\n\nClosed/merged items are accessible via search (see 4.4).\n\n## File\nsrc/app/(authenticated)/dashboard/_components/DashboardClient.tsx\n\n---\n## Acceptance Criteria\nContributes to: AC-6\n\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-ipd: Dashboard shows open items only\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-ipd\n- Update plan: AC-6 -\u003e \"complete\"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:25:01.274962-05:00","updated_at":"2025-12-11T15:10:21.954231-05:00","dependencies":[{"issue_id":"gitlab-insights-ipd","depends_on_id":"gitlab-insights-9ed","type":"blocks","created_at":"2025-12-11T14:26:49.130337-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-kqw","title":"5.2 Conditionally render views","description":"Render appropriate view based on user preference.\n\n## Implementation\nIn DashboardClient.tsx:\n\nconst { data: user } = api.user.getCurrent.useQuery();\n\n{user?.dashboardView === \"grouped\" ? (\n  \u003cWorkItemList ... /\u003e\n) : (\n  \u003cEventTable ... /\u003e // existing flat view\n)}\n\n## File\nsrc/app/(authenticated)/dashboard/_components/DashboardClient.tsx\n\n---\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-kqw: Conditionally render views\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-kqw","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:25:07.304011-05:00","updated_at":"2025-12-11T15:10:35.894364-05:00","dependencies":[{"issue_id":"gitlab-insights-kqw","depends_on_id":"gitlab-insights-9jt","type":"blocks","created_at":"2025-12-11T14:26:04.099267-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-ksg","title":"1.4 Create database migration","description":"Create and run Prisma migration for all schema changes.\n\n## Implementation\n1. Run: npx prisma migrate dev --name add-event-relationships\n2. Migration should:\n   - Preserve User, UserQuery, MonitoredProject tables\n   - Add new columns to Event table\n   - Create ReadEvent table\n   - Add all indexes\n\nNote: This is a clean slate approach. The migration may drop Event data.\nIf data preservation is needed, consider a multi-step migration.\n\n## Verification\n- Run: npx prisma studio\n- Confirm Event table has all new fields\n- Confirm ReadEvent table exists\n- Confirm indexes are created\n\n---\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-ksg: Create database migration for event relationships\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-ksg","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:24:05.973113-05:00","updated_at":"2025-12-11T15:07:52.530323-05:00","dependencies":[{"issue_id":"gitlab-insights-ksg","depends_on_id":"gitlab-insights-bgm","type":"blocks","created_at":"2025-12-11T14:25:46.417562-05:00","created_by":"daemon"},{"issue_id":"gitlab-insights-ksg","depends_on_id":"gitlab-insights-82a","type":"blocks","created_at":"2025-12-11T14:25:46.722584-05:00","created_by":"daemon"},{"issue_id":"gitlab-insights-ksg","depends_on_id":"gitlab-insights-gcv","type":"blocks","created_at":"2025-12-11T14:25:47.048451-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-mkn","title":"Move author to header","description":"in EventTable rows, move author from right-hand section to the header section for easier visibility","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-11T09:44:09.823631-05:00","updated_at":"2025-12-11T09:47:25.638292-05:00","closed_at":"2025-12-11T09:47:25.638292-05:00"}
{"id":"gitlab-insights-myl","title":"1.9 Trigger full data refetch and verify","description":"Refetch all data from GitLab and verify relationships are captured.\n\n## Implementation\n1. Use existing manualRefresh endpoint or create admin endpoint\n2. Trigger full refetch for all monitored projects\n\n## Verification Checklist\n- [ ] Comments have parentEventId set (link to parent issue/MR)\n- [ ] Comments have gitlabParentId set (GitLab IID)\n- [ ] MRs have closesIssueIds populated from API\n- [ ] Issues have status, commentCount, lastActivityAt\n- [ ] MRs have status, commentCount, lastActivityAt\n- [ ] System notes have isSystemNote = true\n- [ ] Assignees arrays are populated\n- [ ] Cross-references (mentionedInIds) are extracted\n\n## Performance Check\n- Run sample queries to verify indexes work\n- Check query times for grouped queries\n\n---\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-myl: Trigger full data refetch and verify\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-myl\n- Update plan: AC-1, AC-2, AC-3 -\u003e \"complete\" (if verified)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:24:12.480671-05:00","updated_at":"2025-12-11T15:08:07.306923-05:00","dependencies":[{"issue_id":"gitlab-insights-myl","depends_on_id":"gitlab-insights-e0h","type":"blocks","created_at":"2025-12-11T14:25:54.636046-05:00","created_by":"daemon"},{"issue_id":"gitlab-insights-myl","depends_on_id":"gitlab-insights-5oj","type":"blocks","created_at":"2025-12-11T14:25:54.881508-05:00","created_by":"daemon"},{"issue_id":"gitlab-insights-myl","depends_on_id":"gitlab-insights-7e5","type":"blocks","created_at":"2025-12-11T14:25:55.083724-05:00","created_by":"daemon"},{"issue_id":"gitlab-insights-myl","depends_on_id":"gitlab-insights-u9b","type":"blocks","created_at":"2025-12-11T14:25:55.280003-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-n7f","title":"3.4 Create participant avatars component","description":"Create overlapping avatar stack component.\n\n## Implementation\nCreate src/app/(authenticated)/dashboard/_components/ParticipantAvatars.tsx\n\nProps:\n- participants: { username: string, avatar?: string }[]\n- maxVisible: number (default 3)\n\n## Layout\nDefault: [A][B][C] +2 more\nHover: [A] [B] [C] [D] [E] (spread animation)\n\n## Styling\n- Avatar size: 24px diameter\n- Overlap: -8px margin\n- Hover animation: framer-motion spread\n- Tooltip: full participant list on hover\n\n## File\nsrc/app/(authenticated)/dashboard/_components/ParticipantAvatars.tsx\n\n---\n## Acceptance Criteria\nContributes to: AC-7\n\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-n7f: Create participant avatars component\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-n7f","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:24:46.37586-05:00","updated_at":"2025-12-11T15:09:54.558045-05:00","dependencies":[{"issue_id":"gitlab-insights-n7f","depends_on_id":"gitlab-insights-uln","type":"blocks","created_at":"2025-12-11T14:26:40.622553-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-ntz","title":"Phase 4: Read Tracking \u0026 Filtering","description":"Implement read tracking integration, smart defaults, and filtering.\n\n## Goal\nWire up read tracking to UI and implement smart sorting/filtering.\n\n## Acceptance Criteria\nContributes to: AC-4, AC-8, AC-9\n\n## On Completion (Epic)\nWhen all Phase 4 tasks complete:\n1. Verify AC-4, AC-8, AC-9 are marked 'complete' in plan file\n2. bd close gitlab-insights-ntz","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-11T14:25:00.569438-05:00","updated_at":"2025-12-11T15:10:21.160892-05:00","dependencies":[{"issue_id":"gitlab-insights-ntz","depends_on_id":"gitlab-insights-pyd","type":"blocks","created_at":"2025-12-11T14:25:36.090897-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-pyd","title":"Phase 3: New UI Components","description":"Build work item card components to replace flat event list.\n\n## Goal\nCreate collapsible card UI showing activity logs, with full content in detail pane.\n\n## Key Files (new)\n- src/app/(authenticated)/dashboard/_components/WorkItemCard.tsx\n- src/app/(authenticated)/dashboard/_components/WorkItemList.tsx\n- src/app/(authenticated)/dashboard/_components/ActivityTimeline.tsx\n\n## Key Files (update)\n- src/app/(authenticated)/dashboard/_components/DashboardClient.tsx\n- src/app/(authenticated)/dashboard/_components/EventDetail.tsx\n\n## Design Reference\n/docs/ux-design-specification.md\n\n## Acceptance Criteria\nContributes to: AC-5, AC-6, AC-7\n\n## On Completion (Epic)\nWhen all Phase 3 tasks complete:\n1. Verify AC-5, AC-6, AC-7 are marked 'ui-ready' or 'complete' in plan file\n2. bd close gitlab-insights-pyd","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-11T14:24:38.190022-05:00","updated_at":"2025-12-11T15:09:21.071515-05:00","dependencies":[{"issue_id":"gitlab-insights-pyd","depends_on_id":"gitlab-insights-0rj","type":"blocks","created_at":"2025-12-11T14:25:35.893617-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-rpy","title":"3.6 Update EventDetail for full content view","description":"Update EventDetail to show full work item content with activity timeline.\n\n## Implementation\nModify src/app/(authenticated)/dashboard/_components/EventDetail.tsx\n\n## Layout\n+--------------------------------------------------+\n| [Breadcrumb: Issue #123 \u003e MR !456]         [x]   |\n|==================================================|\n| [Badge] Issue #123: Fix login timeout bug        |\n|--------------------------------------------------|\n| Status: Open                                     |\n| Author: Alice - 2 days ago                       |\n| Assigned: Bob, Charlie                           |\n| Labels: bug, auth, high-priority                 |\n| Project: gitlab-insights                         |\n|--------------------------------------------------|\n| Description                                      |\n|--------------------------------------------------|\n| [Full markdown rendered description]             |\n|--------------------------------------------------|\n| Related Work                                     |\n|--------------------------------------------------|\n| MR !456 - Implement new auth flow (merged)       |\n|   -\u003e Closes this issue                           |\n|--------------------------------------------------|\n| Activity (5 items)                               |\n|--------------------------------------------------|\n| [ActivityTimeline component]                     |\n|--------------------------------------------------|\n| [Open in GitLab]                                 |\n+--------------------------------------------------+\n\n## Features\n- Use getWorkItemWithActivity query\n- Render full description with markdown\n- Show related items section\n- Embed ActivityTimeline component\n- Breadcrumb navigation for history\n- Scroll to specific activity when clicked from card\n- Mark as read when viewed\n\n## File\nsrc/app/(authenticated)/dashboard/_components/EventDetail.tsx\n\n---\n## Acceptance Criteria\nContributes to: AC-5\n\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-rpy: Update EventDetail for full content view\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-rpy\n- Update plan: AC-5 -\u003e \"complete\"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:24:46.848755-05:00","updated_at":"2025-12-11T15:09:55.047995-05:00","dependencies":[{"issue_id":"gitlab-insights-rpy","depends_on_id":"gitlab-insights-s06","type":"blocks","created_at":"2025-12-11T14:26:03.846516-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-s06","title":"3.3 Create ActivityTimeline component","description":"Create full content timeline for detail pane.\n\n## Implementation\nCreate src/app/(authenticated)/dashboard/_components/ActivityTimeline.tsx\n\nProps:\n- activities: ActivityItem[]\n- highlightId?: string (scroll to this item)\n- onMarkAsRead: (activityId: string) =\u003e void\n\n## ActivityItem Type\n{\n  id: string,\n  type: \"comment\" | \"system\",\n  author: string,\n  authorAvatar?: string,\n  content: string,\n  createdAt: DateTime,\n  isUnread: boolean\n}\n\n## Layout\n\nUser Comment:\n+--------------------------------------------------+\n| [Avatar] Bob - 4 hours ago              [NEW]    |\n|--------------------------------------------------|\n| I think I found the root cause. The session      |\n| timeout is set to 5 minutes but the frontend...  |\n| [full markdown rendered content]                 |\n+--------------------------------------------------+\n\nSystem Activity (compressed):\n+--------------------------------------------------+\n| [gear] Alice changed status: Open -\u003e In Progress |\n|        1 day ago                                 |\n+--------------------------------------------------+\n\n## Styling\n- User comments: primary text, full contrast\n- System activity: gray-500, single line, reduced opacity\n- NEW badge: olive pill\n- Unread items: subtle highlight\n\n## File\nsrc/app/(authenticated)/dashboard/_components/ActivityTimeline.tsx\n\n---\n## Acceptance Criteria\nContributes to: AC-5\n\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-s06: Create ActivityTimeline component\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-s06\n- Update plan: AC-5 -\u003e \"ui-ready\"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:24:38.934403-05:00","updated_at":"2025-12-11T15:09:21.727959-05:00","dependencies":[{"issue_id":"gitlab-insights-s06","depends_on_id":"gitlab-insights-tng","type":"blocks","created_at":"2025-12-11T14:26:40.408154-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-tng","title":"2.2 Create getWorkItemWithActivity endpoint","description":"Create tRPC endpoint returning full context for a single work item.\n\n## Implementation\nAdd to src/server/api/routers/events.ts:\n\ngetWorkItemWithActivity: protectedProcedure\n  .input(z.object({ eventId: z.string() }))\n  .query(async ({ ctx, input }) =\u003e {\n    // Load the work item\n    // Load all children (comments) ordered by createdAt\n    // Load related MRs (where closesIssueIds includes this issue)\n    // Load related issues (if MR, lookup closesIssueIds)\n    // Load cross-references (mentionedInIds)\n    // Build unified activity timeline\n    return {\n      workItem: Event,\n      comments: Event[],\n      relatedMRs: Event[],\n      relatedIssues: Event[],\n      crossReferences: Event[],\n      participants: string[],\n      activityTimeline: ActivityItem[]\n    }\n  })\n\nEager load with Prisma includes.\nPaginate if \u003e50 activity items.\n\n## File\nsrc/server/api/routers/events.ts\n\n---\n## Acceptance Criteria\nContributes to: AC-5\n\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-tng: Create getWorkItemWithActivity endpoint\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-tng\n- Update plan: AC-5 -\u003e \"implemented\"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:24:25.283554-05:00","updated_at":"2025-12-11T15:08:38.29715-05:00","dependencies":[{"issue_id":"gitlab-insights-tng","depends_on_id":"gitlab-insights-myl","type":"blocks","created_at":"2025-12-11T14:26:28.608868-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-u9b","title":"1.8 Parse cross-references (mentionedInIds)","description":"Parse description and body text for issue/MR references.\n\n## Implementation\nCreate utility function to extract references:\n- Regex pattern for #123 (issues) and !456 (MRs)\n- Extract numeric IIDs\n- Store in mentionedInIds[]\n\nApply to:\n- Issue descriptions\n- MR descriptions\n- Comment bodies\n\n## File\nsrc/server/services/gitlab/event-transformer.ts\n\n---\n## Acceptance Criteria\nContributes to: AC-3\n\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-u9b: Parse cross-references (mentionedInIds)\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-u9b\n- Update plan: AC-3 -\u003e \"implemented\"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:24:12.247888-05:00","updated_at":"2025-12-11T15:08:06.976057-05:00","dependencies":[{"issue_id":"gitlab-insights-u9b","depends_on_id":"gitlab-insights-ksg","type":"blocks","created_at":"2025-12-11T14:25:48.304455-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-uln","title":"2.1 Create getWorkItemsGrouped endpoint","description":"Create tRPC endpoint returning grouped work items for dashboard.\n\n## Implementation\nAdd to src/server/api/routers/events.ts:\n\ngetWorkItemsGrouped: protectedProcedure\n  .input(z.object({\n    status: z.enum([\"open\", \"all\"]).default(\"open\"),\n    sort: z.enum([\"activity\", \"unread\"]).default(\"unread\")\n  }))\n  .query(async ({ ctx, input }) =\u003e {\n    // Query issues (type = \"issue\", exclude comments)\n    // Query MRs (type = \"merge_request\", exclude comments)\n    // Join with ReadEvent to get unread status\n    // Sort: unread first, then by lastActivityAt\n    // Return { issues: WorkItemSummary[], mergeRequests: WorkItemSummary[] }\n  })\n\nWorkItemSummary type:\n{\n  event: Event,\n  unreadComments: number,\n  lastActivity: DateTime,\n  participants: string[],\n  status: string,\n  hasNewActivity: boolean\n}\n\n## File\nsrc/server/api/routers/events.ts\n\n---\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-uln: Create getWorkItemsGrouped endpoint\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-uln","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:24:25.046698-05:00","updated_at":"2025-12-11T15:08:38.054457-05:00","dependencies":[{"issue_id":"gitlab-insights-uln","depends_on_id":"gitlab-insights-myl","type":"blocks","created_at":"2025-12-11T14:26:28.388248-05:00","created_by":"daemon"}]}
{"id":"gitlab-insights-w2u","title":"3.7 Add skeleton loading states","description":"Add skeleton loading patterns for cards and detail pane.\n\n## Implementation\nCreate or update skeleton components:\n\nCard skeleton:\n+--------------------------------------------------+\n| [====] [================]              [==] [=]  |\n| [========] - [====] - [======]                   |\n| [====] [==] [==]                                 |\n| [================================]               |\n+--------------------------------------------------+\n\nDetail pane skeleton:\n+--------------------------------------------------+\n| [================================]               |\n|--------------------------------------------------|\n| [======]: [========]                             |\n| [======]: [============]                         |\n|--------------------------------------------------|\n| [====================================]           |\n| [====================================]           |\n| [====================]                           |\n|--------------------------------------------------|\n| [Activity skeleton items...]                     |\n+--------------------------------------------------+\n\n## Files\n- Update WorkItemCard.tsx with loading state\n- Update WorkItemList.tsx with skeleton cards\n- Update EventDetail.tsx with skeleton content\n\n---\n## On Completion\n\n### 1. Commit Changes\njj describe -m \"gitlab-insights-w2u: Add skeleton loading states\"\njj new  # Only if continuing to next task\n\n### 2. Code Review\n- Run code-review-changeset agent on the changeset\n- Address ALL issues identified\n- If anything is ambiguous or would deviate from established architecture/patterns:\n  - STOP and seek developer input before proceeding\n  - Do not make assumptions about architectural decisions\n\n### 3. Human Approval\n- Present summary of changes to developer\n- Wait for explicit approval before closing\n\n### 4. Close Bead\n- bd close gitlab-insights-w2u","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-11T14:24:47.076438-05:00","updated_at":"2025-12-11T15:09:55.260641-05:00","dependencies":[{"issue_id":"gitlab-insights-w2u","depends_on_id":"gitlab-insights-uln","type":"blocks","created_at":"2025-12-11T14:26:40.85034-05:00","created_by":"daemon"}]}
