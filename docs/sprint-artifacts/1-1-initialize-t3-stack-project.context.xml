<story-context id=".bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>1</epicId>
    <storyId>1.1</storyId>
    <title>Initialize T3 Stack Project</title>
    <status>drafted</status>
    <generatedAt>2025-11-21</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/sprint-artifacts/1-1-initialize-t3-stack-project.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>developer</asA>
    <iWant>to initialize the gitlab-insights project with T3 Stack</iWant>
    <soThat>I have a pre-configured full-stack setup with type-safe APIs, authentication, and database ORM optimized for rapid development</soThat>
    <tasks>
      - Initialize T3 Stack Project (AC: 1, 2, 3, 5)
        * Run `npm create t3-app@latest gitlab-insights -- --trpc --prisma --nextAuth --tailwind --typescript --dbProvider postgres`
        * Verify project structure matches T3 conventions (src/server, src/app, src/lib)
        * Start development server and verify it loads without errors
        * Confirm TypeScript compilation passes with `npm run build`

      - Configure Tailwind v4 and Olive Accent Colors (AC: 4)
        * Upgrade Tailwind CSS to v4 as specified in architecture
        * Add custom color configuration to tailwind.config.ts
        * Define olive accent colors: --accent-light: #9DAA5F (dark mode), --accent-dark: #5e6b24 (light mode)
        * Add hover variants: --accent-hover-light: #A8B86C, --accent-hover-dark: #4F5A1F
        * Configure 8px spacing grid system
        * Add animation classes for slide-in/slide-out (200ms ease-out)

      - Environment Configuration Setup (AC: 6)
        * Create .env.example with placeholder values
        * Document required environment variables
        * Add .env to .gitignore
        * Create local .env file from .env.example

      - Initialize Git Repository (AC: 7)
        * Run `git init` if not already initialized
        * Verify .gitignore includes: .env, node_modules/, .next/, .vercel/
        * Create initial commit: "Initial T3 Stack project setup"
        * Verify all sensitive files are excluded from version control

      - Verify Project Health
        * Run `npm run dev` and access http://localhost:3000
        * Verify no console errors in browser
        * Verify TypeScript compilation and linting pass
    </tasks>
  </story>

  <acceptanceCriteria>
    1. T3 Stack project initializes successfully with all required dependencies (Next.js, TypeScript, tRPC, Prisma, NextAuth, Tailwind CSS)
    2. Development server starts without errors on `http://localhost:3000`
    3. All TypeScript compilation passes with zero errors
    4. Tailwind CSS configuration includes olive accent color system (#5e6b24 light, #9DAA5F dark)
    5. Project structure follows T3 Stack conventions with proper folder organization
    6. Environment variables template (.env.example) created with required configuration fields
    7. Git repository initialized with meaningful initial commit and .gitignore configured
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>docs/architecture.md</path>
        <title>System Architecture</title>
        <section>Project Initialization</section>
        <snippet>T3 Stack initialization command and post-installation configuration. Includes environment variable setup, NextAuth GitLab provider configuration, and Prisma migration steps. Architecture specifies Tailwind v4 upgrade requirement.</snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>System Architecture</title>
        <section>ADR-001: T3 Stack for Rapid Development</section>
        <snippet>Decision to use T3 Stack provides pre-configured full-stack setup with type-safe APIs, authentication, and database ORM. Optimizes for development velocity while maintaining production quality.</snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>System Architecture</title>
        <section>Project Structure</section>
        <snippet>Complete source tree with architectural boundaries. Defines folder organization: src/server (tRPC, auth, db), src/app (Next.js pages), src/lib (utilities), src/components (UI), src/inngest (background jobs).</snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>System Architecture</title>
        <section>Architecture Constraints</section>
        <snippet>No backend separate service - all server logic in Next.js API routes. Stateless API with no session state in memory. User-scoped data pattern. OAuth only authentication.</snippet>
      </doc>
      <doc>
        <path>docs/sprint-artifacts/tech-spec-epic-1.md</path>
        <title>Epic 1 Technical Specification: Walking Skeleton</title>
        <section>Tech Stack (T3 Stack)</section>
        <snippet>Detailed tech stack initialization: Next.js 15, TypeScript 5.x, tRPC 11.x, Prisma 5.x, NextAuth 4.24.x, Tailwind v4, React Aria Components 3.x. Includes specific version requirements and configuration notes.</snippet>
      </doc>
      <doc>
        <path>docs/sprint-artifacts/tech-spec-epic-1.md</path>
        <title>Epic 1 Technical Specification: Walking Skeleton</title>
        <section>Environment Variables</section>
        <snippet>Required environment variables for Epic 1: DATABASE_URL, NEXTAUTH_SECRET, NEXTAUTH_URL, GITLAB_INSTANCE_URL, GITLAB_CLIENT_ID, GITLAB_CLIENT_SECRET, NODE_ENV. Includes security notes and OAuth app creation guidance.</snippet>
      </doc>
      <doc>
        <path>docs/ux-design-specification.md</path>
        <title>UX Design Specification</title>
        <section>1.1 Design System Choice</section>
        <snippet>React Aria Components selected for exceptional keyboard navigation and progressive enhancement. WCAG AA+ accessibility out of the box. Unstyled components allow custom olive accent color (#5e6b24).</snippet>
      </doc>
      <doc>
        <path>docs/ux-design-specification.md</path>
        <title>UX Design Specification</title>
        <section>3.1 Color System</section>
        <snippet>Olive/moss green accent color system defined. Dark mode: #9DAA5F, Light mode: #5e6b24. Includes hover states and complete neutral gray scale. Semantic colors for success, warning, error, info.</snippet>
      </doc>
      <doc>
        <path>docs/prd.md</path>
        <title>Product Requirements Document</title>
        <section>Project Classification</section>
        <snippet>Technical type: web_app, Domain: general, Complexity: low. Polling-based architecture with scheduled GitLab API fetching, background processing, aggressive caching for sub-500ms performance.</snippet>
      </doc>
      <doc>
        <path>docs/prd.md</path>
        <title>Product Requirements Document</title>
        <section>Performance Targets</section>
        <snippet>Page load <500ms (hard requirement), search results <1s, JavaScript bundle <300KB gzipped, CSS <50KB gzipped, time to interactive <1s on 4G connection.</snippet>
      </doc>
    </docs>

    <code>
      <!-- No existing code - greenfield project initialization -->
      <note>This is the first story in the project. No existing code to reference. The T3 Stack initialization will create the foundational project structure.</note>
    </code>

    <dependencies>
      <note>Dependencies will be installed by T3 Stack initialization command. Expected packages:</note>
      <npm>
        <core>
          <package name="next" version="~15.x" />
          <package name="react" version="^19" />
          <package name="typescript" version="~5.x" />
        </core>
        <t3-stack>
          <package name="@trpc/client" version="^11.x" />
          <package name="@trpc/server" version="^11.x" />
          <package name="@trpc/react-query" version="^11.x" />
          <package name="@tanstack/react-query" version="latest" />
          <package name="@prisma/client" version="^6.x" />
          <package name="prisma" version="^6.x" dev="true" />
          <package name="next-auth" version="^4.24.x" />
          <package name="tailwindcss" version="^4.x" />
          <package name="zod" version="latest" />
        </t3-stack>
        <future>
          <package name="react-aria-components" version="^3.x" note="To be added in Story 1.7" />
          <package name="date-fns" version="latest" note="For timestamp formatting" />
        </future>
      </npm>
    </dependencies>
  </artifacts>

  <constraints>
    <architectural>
      - No backend separate service: All server logic runs in Next.js API routes and tRPC procedures (collocated monolith pattern)
      - Stateless API: No session state in memory; all session data stored in PostgreSQL via NextAuth
      - User-scoped data: All database queries must filter by userId to prevent data leakage and enable horizontal scaling
      - OAuth only: No local password authentication; GitLab OAuth required (security constraint NFR-S1)
    </architectural>

    <performance>
      - Page load target: <500ms (hard requirement per PRD)
      - Build time: Must be reasonable for development iteration
      - Bundle size limits: <300KB JS gzipped (initial load), <50KB CSS gzipped
      - Time to Interactive: <1s on 4G connection
    </performance>

    <configuration>
      - Tailwind CSS must be upgraded to v4 (architecture requirement)
      - Custom olive accent color system required: #5e6b24 (light mode), #9DAA5F (dark mode)
      - 8px spacing grid system must be configured
      - Animation classes for slide-in/slide-out (200ms ease-out) required for future split pane feature
    </configuration>

    <security>
      - .env file MUST be in .gitignore (never commit sensitive values)
      - Environment variables must use .env.example template pattern
      - All OAuth credentials stored in environment variables, never hardcoded
    </security>

    <testing>
      - ADR-006: Minimal testing for fast iteration during MVP phase
      - Unit tests ONLY for critical business logic (not infrastructure)
      - NO integration or E2E tests during Epic 1
      - Philosophy: Fast iteration over test coverage
      - Manual validation sufficient for project initialization
    </testing>
  </constraints>

  <interfaces>
    <note>No existing interfaces - this story creates the foundational structure</note>
    <future>
      <interface>
        <name>tRPC Router API</name>
        <kind>Type-safe RPC</kind>
        <signature>Will be defined in subsequent stories starting with Story 1.3 (auth router)</signature>
        <path>src/server/api/root.ts</path>
      </interface>
      <interface>
        <name>Prisma Client</name>
        <kind>Database ORM</kind>
        <signature>Will be configured in Story 1.2 with database schema</signature>
        <path>src/server/db.ts</path>
      </interface>
      <interface>
        <name>NextAuth Configuration</name>
        <kind>Authentication</kind>
        <signature>Will be configured in Story 1.3 with GitLab OAuth provider</signature>
        <path>src/server/auth.ts</path>
      </interface>
    </future>
  </interfaces>

  <tests>
    <standards>
      Per ADR-006 (Minimal Testing for Fast Iteration), this story requires only manual validation. No automated tests for infrastructure setup. Manual testing checklist:
      1. Development server starts successfully (npm run dev)
      2. Homepage loads at http://localhost:3000
      3. TypeScript compilation passes (npm run build)
      4. Linting passes (npm run lint)
      5. No console errors in browser
      6. .env file properly gitignored
    </standards>

    <locations>
      N/A - No automated tests for project initialization per testing strategy
    </locations>

    <ideas>
      <test ac="1">Manual: Verify T3 Stack installation completes without errors and all expected dependencies are in package.json</test>
      <test ac="2">Manual: Start dev server and verify http://localhost:3000 loads the T3 welcome page</test>
      <test ac="3">Manual: Run `npm run build` and verify TypeScript compilation passes with zero errors</test>
      <test ac="4">Manual: Inspect tailwind.config.ts and verify olive color system is configured correctly</test>
      <test ac="5">Manual: Verify directory structure matches T3 conventions (src/server, src/app, src/lib exist)</test>
      <test ac="6">Manual: Verify .env.example exists with all required variables documented</test>
      <test ac="7">Manual: Run `git status` and verify .env is not tracked, verify initial commit exists</test>
    </ideas>
  </tests>
</story-context>
